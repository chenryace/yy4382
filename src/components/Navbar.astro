---
import { Icon } from "astro-icon/components";
import { type NavMenu, navMenu } from "../config";
import { siteConfig } from "../config";
import SearchPanel from "./SearchPanel.astro";
import Card from "./base/Card.astro";
---

<Card class="rounded-t-none h-18 px-3 min-h-16 flex justify-between">
  <div class="navbar-start self-center">
    <a class="flex items-center text-xl btn-color" href="/1">
      <img src="/ava.webp" alt="logo" class="w-8 h-8 rounded-full mr-2" />
      {siteConfig.title}
    </a>
  </div>
  <div class="hidden lg:flex lg:min-h-full">
    <ul class="flex gap-1 items-center" id="navList">
      {
        navMenu.map((item: NavMenu) => (
          <li class="btn-plain flex items-center my-auto px-2 rounded-md font-semibold min-h-12">
            <a href={item.link} class="">
              {item.text}
            </a>
          </li>
        ))
      }
    </ul>
  </div>
  <div class="flex items-center">
    <SearchPanel />
    <a
      href="/feed.xml"
      class="btn-plain flex items-center h-fit rounded-md mr-2"
      aria-label="RSS feed link"
    >
      <Icon name="ic:outline-rss-feed" class="w-9 h-9 p-1" />
    </a>
    <button
      class="toggle-menu btn-plain flex items-center h-fit rounded-md lg:hidden"
    >
      <Icon name="ic:outline-menu" class="w-9 h-9" />
    </button>
  </div>
  <div
    id="navListMobile"
    class="absolute hidden flex-col z-10 btn-card rounded-md border-2 top-20 right-2"
  >
    {
      navMenu.map((item) => {
        return (
          <a
            href={item.link}
            class="btn-plain flex-grow my-auto px-2 py-2 rounded-md font-semibold text-center flex"
          >
            {item.text}
            <Icon
              name="mdi:chevron-right"
              class="w-5 h-5 self-center"
              size={20}
            />
          </a>
        );
      })
    }
  </div>
</Card>
<script>
  function setup() {
    const menuBtns = document.querySelectorAll("button.toggle-menu");
    menuBtns.forEach((button) => {
      button.addEventListener("click", () => {
        const navList = document.getElementById("navListMobile");
        navList?.classList.toggle("hidden");
        navList?.classList.toggle("flex");
      });
    });
  }

  document.addEventListener(
    "astro:page-load",
    () => {
      setup();
    },
    { once: false },
  );
</script>
